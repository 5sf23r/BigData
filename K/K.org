* 目录                                                                          :TOC_5:QUOTE:
#+BEGIN_QUOTE
- [[#数据分析步骤][数据分析步骤]]
- [[#一-excel知识要点][一. Excel知识要点]]
  - [[#1-什么是数据][1. 什么是数据]]
    - [[#11-字段与纪录][1.1 字段与纪录]]
      - [[#111-什么是数据][1.1.1 什么是数据？]]
    - [[#12-在excel中看出数据的类型][1.2 在Excel中看出数据的类型]]
      - [[#121-设置单元格格式][1.2.1 设置单元格格式]]
    - [[#13-数据表的呈现][1.3 数据表的呈现]]
      - [[#131-二维表与一维表的关系][1.3.1 二维表与一维表的关系]]
  - [[#2-获取数据的来源][2. 获取数据的来源]]
    - [[#21-网站数据导入及更新][2.1 网站数据导入及更新]]
      - [[#211-导入网站数据][2.1.1 导入网站数据]]
      - [[#212-刷新][2.1.2 刷新]]
    - [[#22-文本数据导入][2.2 文本数据导入]]
      - [[#221-文本数据导入][2.2.1 文本数据导入]]
      - [[#222-分割方式][2.2.2 分割方式]]
  - [[#3-学会处理数据][3. 学会处理数据]]
    - [[#31-数据的清理][3.1 数据的清理]]
      - [[#311-高级筛选法][3.1.1 高级筛选法]]
      - [[#312-函数筛选法][3.1.2 函数筛选法]]
      - [[#313-删除重复数据法][3.1.3 删除重复数据法]]
      - [[#314-条件格式法][3.1.4 条件格式法]]
      - [[#315-数据透视法][3.1.5 数据透视法]]
      - [[#316-快速填充][3.1.6 快速填充]]
      - [[#317-查找替换][3.1.7 查找替换]]
      - [[#318-数据分列][3.1.8 数据分列]]
    - [[#32-数据的计算][3.2 数据的计算]]
      - [[#321-函数的总结][3.2.1 函数的总结]]
      - [[#322-函数引入][3.2.2 函数引入]]
    - [[#33-常用公式][3.3 常用公式]]
      - [[#331-数据清洗类][3.3.1 数据清洗类]]
      - [[#332-关联匹配类难点][3.3.2 关联匹配类（难点）]]
      - [[#333-逻辑运算类][3.3.3 逻辑运算类]]
      - [[#334-计算统计类][3.3.4 计算统计类]]
      - [[#335-时间序列类][3.3.5 时间序列类]]
  - [[#4-总结][4. 总结]]
  - [[#5-拓展][5. 拓展]]
    - [[#51-index--match--vlookup][5.1 Index + match = vlookup]]
    - [[#52-快捷键学习][5.2 快捷键学习]]
- [[#二-python基础][二. Python基础]]
  - [[#1-注释][1. 注释]]
  - [[#2-变量的定义][2. 变量的定义]]
  - [[#3-变量的命名规则][3. 变量的命名规则]]
    - [[#变量命名][变量命名]]
  - [[#4-关键字][4. 关键字]]
#+END_QUOTE

* 数据分析步骤
举例解决单身，追TA
1. 目标导向：追谁
2. 数据收集：QQ空间、朋友圈、周围人
3. 数据处理：过滤掉部分信息
4. 数据分析：送什么\约会
5. 数据展示：小本本记下来
6. 数据报告：决定，


* 一. Excel知识要点
** 1. 什么是数据
*** 1.1 字段与纪录
**** 1.1.1 什么是数据？
数据就是数值，也就是我们通过观察、实验或者计算得出的结果。数据有很多种，最简单的就是数字。数据也可以是文字、图像、声音等。数据可以是文字、图像、声音等。数据可以用于科学研究、设计、查证等。
+ 数据不是一个独立的部分，只有将字段和记录组合在一起，才能算一个完整的数据。
+ 字段是可以概括事物、特征的现象。
+ 记录是一种具体表现型
[[./img/1.png]]
*** 1.2 在Excel中看出数据的类型
+ Excel中的数据分为两类：数值型和字符型
  - 数值型数据
    是指直接使用自然数或度量衡单位进行计量的具体的数值，如销售数量、销售金额等。对数值型数据来说，可以直接用算术方法进行汇总和分析，而对其他类型的数据则需特殊方法来处理。
  - 字符型数据
    是指不具备计算能力的文字数据，它包括中文字符、英文字符、数字字符和其他字符，如销售人员、地区、产品名称等等。
**** 1.2.1 设置单元格格式
- 1. 选择需要设置的单元格，单机右键---选择设置单元格格式
- 2. 选择日期---选择日期格式---确定
- 3. 最终显示如图
  [[./img/2.png]]
  [[./img/3.png]]
*** 1.3 数据表的呈现
**** 1.3.1 二维表与一维表的关系
[[./img/4.png]]
** 2. 获取数据的来源
*** 2.1 网站数据导入及更新
**** 2.1.1 导入网站数据
- 1. 选择“数据”现象卡---自网站
- 2. 弹出“新建web查询”对话框---输入网站网址---转到---选择需要获取数据的区域---点击导入
- 3. 选择数据导入的区域---点击确定
- 4. 如图所示
  [[./img/5.png]]
**** 2.1.2 刷新
- 1. 选择需要刷新的数据---“数据”选项卡---全部刷新---链接属性
- 2. 设置刷新频率或者打开文件时属性数据---确定即可
  [[./img/6.png]]
*** 2.2 文本数据导入
**** 2.2.1 文本数据导入
- 1. “数据”选项卡---选择自文本
- 2. 弹出“导入文本文件”选择需要导入的文本工作
- 3. 如图所示
  [[./img/7.png]]
**** 2.2.2 分割方式
1. 分隔符号分割
   + 1. 选择“分隔符号”---下一步
   + 2. 按照“分隔符号”选择对应的分割符，在数据预览可看到执行效果---下一步
   + 3. 导入后的数据格式选择（一般默认常规就好），完成即可导入文本数据
   + 4. 选择导入的工作表位置
   + 5. 如图所示
     [[./img/8.png]]
2. 固定宽度分割
   + 1. 选择“固定宽度”---下一步
   + 2. 在何时的位置单机鼠标左键，会显示分割线---下一步---选择常规---完成---选择导入工作表区域---确定
   + 3. 如图所示
     [[./img/9.png]]
- 根据自己的业务需求，导入不同的文本文件，可以对数据更快的进行分析
** 3. 学会处理数据
*** 3.1 数据的清理
**** 3.1.1 高级筛选法
- 1. 选中需要筛选的区域---“数据”选项卡---单击“高级”
- 2. 将筛选结果复制到其他位置---勾选---选择不重复的记录---选择复制到---选择单元格B1
- 3. 如图所示
  [[./img/10.png]]
**** 3.1.2 函数筛选法
- 1. 借助辅助列---在F2单元格中输入公式“=COUNTIF(E:E,E2)”---筛选出每个学号重复的次数：
- 2. 在G2输入公式“=COUNTIF(E$2:E2,E2)”---筛选出每个选好再次重复的次数
- 3. 如图所示
  [[./img/11.png]]
**** 3.1.3 删除重复数据法
1. 排序删除重复项
   - 1. 借助之前做的“再次重复标记”---单击其中一个单元格---选择“开始”选项卡---点“击排序和筛选”
     [[./img/12.png]]
   - 2. 选择“降序”
   - 3. 找到重复项
   - 4. 右键选择删除---整行，将所有重复次数大于1的就删除
     [[./img/13.png]]
2. 筛选删除重复项
   - 1. “开始”选项卡---排序和筛选---选择筛选，标题出现倒三角选择符号
   - 2. 点击倒三角---数字筛选---自定义筛选
   - 3. 设置等于1---确定，即可筛选出出现一次的学号
     [[./img/14.png]]
3. 删除菜单重复项
   - 1. 选择“数据”选项卡---点击“删除重复项”
   - 2. 选择“学员”
     [[./img/15.png]]
**** 3.1.4 条件格式法
- 1. 在“开始”选项卡下，条件格式---突出显示单元格规则---重复值
- 2. 选择将重复值填充颜色文本（随便选一种即可）
  [[./img/16.png]]
**** 3.1.5 数据透视法
- 1. 选择要透视的数据区域---“插入”选项卡---数据透视表---选择透视表呈现的区域
  [[./img/17.png]]
- 2. 将“学号”字段拖入“行”和“值”中
- 3. 值字段设置为计数
  [[./img/18.png]]
**** 3.1.6 快速填充
- 1. 在B1输入沈阳，将鼠标移动至单元格右下角，出现填充柄
- 2. 把填充柄拖至末尾单元格，选择图标中的快速填充，即可完成城市的提取
  [[./img/19.png]]
- 3. 在D2单元格输入“辽宁沈阳”，然后点击下一个单元格D3，键盘同事按下Ctrl+E，实现快速填充
  [[./img/20.png]]
**** 3.1.7 查找替换
- 1. “开始”选项卡---“查找和选择”---“定位条件”（也可以使用快捷键：Ctrl+G）
- 2. 勾选空值---确定
  [[./img/21.png]]
- 3. 定位效果如下
  [[./img/22.png]]
- 4. 输入100，同时按下Ctrl+Enter，可快速填充所有空值为100
  [[./img/23.png]]
**** 3.1.8 数据分列
- 1. 先将VS替换为英文逗号符
- 2. 选择“数据”选项卡---“分列”
  [[./img/23.png]]
- 3. 选择分隔符号---下一步
- 4. 选择逗号分隔
- 5. 完成即可实现分列
  [[./img/24.png]]
*** 3.2 数据的计算
**** 3.2.1 函数的总结
[[./img/25.png]]
**** 3.2.2 函数引入
利用函数解答
[[./img/26.png]]
- a. 求平均值---AVERAGE
- b. 求和---SUM
- c. 求最大值---MAX
- d. 求最小值---MIN
[[./img/27.png]]
- e. 判断---IF
- f. 条件和---SUMIF
- g. 多条件求和---SUMIFS
- h. 数据匹配---VLOOKUP
[[./img/28.png]]

+ 数组
  具有某种联系的多个元素的组合，例如：某个班级，班级里有30名学生，班级为一个数组，而学生是其中的元素。数组公式的标志：在Excel中数组公式的显示是用大括号对"{}"来括住以区分普通Excel公式。
+ 普通求和：
  "=SUM(C3,D3,E3)"或者"=C3+D3+E3"
+ 数组求和：
  "{=C3:C11+D3:D11+E3:E11}"
  [[./img/29.png]]
+ 认识SUMPRODUCT
  多条件求和，推荐使用
  [[./img/30.png]]
+ 绝对引用于相对引用
  - 1. 相对引用：
       复制公式时，单元格地址不会跟着变化(A1)
  - 2. 绝对引用:
       复制公式时，单元格地址不会跟着变化($A$1)
  - 3. 混合引用：
       复制公式时，部分内容跟着变化(A$1或者$A1)
  在引用的过程中，用快捷键shift+F4对单元格进行锁定，“查水表案例”如图：输入公式"=N$2&$M3&$K$2"
  [[./img/31.png]]
*** 3.3 常用公式
**** 3.3.1 数据清洗类
- Trim
  + 1. 功能：去除单元格两端的空格。
  + 2. 语法：=TRIM(text)
- Concatenate
  + 1. 功能：链接单元格内的内容。
  + 2. 语法：=CONCATENATE(text1,[text2],...)
  [[./img/32.png]]
- left right mid
  + MID功能：提取字符串中间的字符串。语法：=MID(text,start_num,num_chars)
  + LEFT功能：提取字符串左边的字符串。语法：=LEFT(text,[num_chars])
  + RIGHT功能：提取字符串右边的字符串。语法：=RIGHT(text,[num_chars])
  [[./img/33.png]]
- replace
  + 1. 功能：
       替换字符串中的连续几个字符或者某个字符。
  + 2. 语法：
       =REPLACE(old_text,start_num,num_chars,new_text)
  [[./img/34.png]]
- substitute
  + 1. 功能：
       替换字符串中的连续几个字符或者某个字符。
  + 2. 语法：
       =SUBSTITUTE(text,old_text,new_text,[instance_num])
  [[./img/35.png]]
**** 3.3.2 关联匹配类（难点）
- Vlookup及$
  + 1. 功能：
       搜索表区域首列满足条件的元素，确定待检索单元格在区域中的行序号，在进一步返回选定单元格的值。
  + 2. 语法：
       =VLOOKUP(lookup_value,table_array,col_index_num,[range_lookup])
- hlookup：
  + 1. 功能：
       搜索数组区域首行满足条件的元素，确定待检索单元格在区域中的列序号，在进一步返回选定单元格的值。
  + 2. 语法：
       =VLOOKUP(lookup_value,table_array,row_index_num,[range_lookup])
- rank
  + 1. 功能：
       返回一列数字的数字排位。数字的排位是其相对于列表中其他值的大小。
  + 2. 语法：
       RANK(number,ref,[order])
  [[./img/36.png]]
**** 3.3.3 逻辑运算类
- if
  + 1. 功能：
       判断是否满足某个条件，满足返回一个值，不满足返回另一个值。
  + 2. 语法：
       IF(logical_test,value_if_true,[value_if_false])
  [[./img/37.png]]
- and
  + 1. 功能：
       逻辑判断，相当于“并”。
  + 2. 语法：
       全部参数为True，则返回True
- or
  + 1. 功能：
       逻辑判断，相当于“或”。
  + 2. 语法：
       只要参数有一个True，则返回True
**** 3.3.4 计算统计类
+ Count/Countif/Countifs
  - Countifs
    + 1. 功能：
         多条件统计。
    + 2. 语法：
         COUNTIFS(criteria_range1,criteria1,[criteria],[criteria_range2,criteria2],...)
+ sum/sumif/sumifs
  - sumif
    + 1. 功能：
         条件求和。
    + 2. 语法：
         SUMIF(range,criteria,[sum_range])
  - sumifs
    + 1. 功能：
         多条件求和。
    + 2. 语法：
         SUMIFS(sum_range,criteria_range1,criteria1,[criteria_range2,criteria2],...)
+ average
  - 1. 功能：
       返回参数的平均值（算数平均值）。
  - 2. 语法：
       AVERAGE(number1,[number2],...)
+ averageifs
  - 1. 功能：
       返回满足多个条件的所有单元格的平均值（算术平均值）。
  - 2. 语法：
       AVERAGEIFS(average_range,criteria_ranger1,criteria1,[criteria_range2,criteria2],...)
**** 3.3.5 时间序列类
+ year/month/day
  - year
    + 1. 功能：
         返回对应于某个日期的年份。Year作为1900 - 9999之间的整数返回。
    + 2. 语法：
         YEAR(serial_number)
  - month
    + 1. 功能：
         返回对应于某个日期的月份。
    + 2. 语法：
         MONTH(serial_number)
  - day
    + 1. 功能：
         返回对应于某个日期的某天。
    + 2. 语法：
         DAY(serial_number)
  - dateif
    + 1. 功能：
         计算两个日期之间相隔的天数、月数或年数。
      2. 语法：
         DATEDIF(start_date,end_date,unit)

** 4. 总结
- 1. 数据的构成是有字段与记录组成的
- 2. Excel的数据类型有数值型和字符型
- 3. 导入不同的数据源，分隔方式有多重，如：Tab键分割，逗号分隔等等
- 4. 数据清洗可以用高级筛选、函数筛选、删除重复法、条件格式法等等
- 5. 五类常用函数应用，如：关联匹配、计算统计等等---重点掌握
** 5. 拓展
*** 5.1 Index + match = vlookup
  + index
    - 1. 功能：
      根据位置返回单元格的值。
    - 2. 语法：
      =INDEX(array,row_num,[column_num])
  + match
    - 1. 功能：
      返回符号特定值，特定顺序的项在数组中的相对位置。
    - 2. 语法：
      =INDEX(lookup_value,lookup_array,[match_type])
*** 5.2 快捷键学习
- Ctrl + C 复制
- Ctrl + V 粘贴
- Ctrl + S 保存
- Ctrl + F 查找
- Ctrl + H 替换
- Ctrl + E 快速填充
- Ctrl + T 快速制表
- Ctrl + D 向下快速填充
- Ctrl + R 向右快速填充
- Ctrl + G 定位条件
- Ctrl + Enter 快速填充（粘贴多项）
- Alt + = 快速求和
- Ctrl + shift + Enter 数组求和
- Ctrl + shift + ； 获取当前时间
- Ctrl + ； 获取当前日期
- Shift + Enter 同时打开多个工作簿
- Shift + F8 激活“多个单元格选项”
* 二. Python基础
** 1. 注释
注释：对代码的解释和说明，可以提供代码的可读性。
#+BEGIN_EXAMPLE
注释分为单行注释和多行注释
单行注释是以#开始
多行注释，可以使用三个双引号或者三个单引号''' ''' """ """
#+END_EXAMPLE
#+BEGIN_SRC python
  # 定义字符串变量name
  name = "李四"

  '''
  我是多行注释
  我是多行注释
  我是多行注释
  '''

  age = 19

  """
  我也是多行注释
  我也是多行注释
  我也是多行注释
  """
  sex = '男'
#+END_SRC
*注意：* ctr + / -> 单行注释快捷键
** 2. 变量的定义
- 1. 变量：通俗理解就是存储程序数据的容器。
- 2. 变量定义的格式：变量名 = 数据（变量名尽量有含义，方便理解）
#+BEGIN_SRC python
  # 定义了一个变量名字叫做score,存储的数据是100
  score = 100
  print(score)

  name = "张三"
  print(name)

  pi = 3.14
  print(pi)

  is_ok = True
  print(is_ok)

  # 提示：在python里面不需要指定数据的类型，会根据数据自动推导出数据类型

  # 通过type查看变量的类型
  score_type = type(score)
  print(score_type)

  name_type = type(name)
  print(name_type)

  pi_type = type(pi)
  print(pi_type)

  print(type(is_ok))
#+END_SRC
*总结：* 常用的数据类型 int，str，float，bool，list，tuple，dict，set
** 3. 变量的命名规则
变量名：是由字母、数字、下划线组成，注意是只有这三种，但是不能以数字开头。
*** 变量命名
驼峰命名法和下划线命名法
- 1. 驼峰命名法：
  + 大驼峰
    每个单词首字母都大写
  + 小驼峰
    第一个单词首字母要小写，其他单词首字母都大写
- 2. 下划线命名法：
  单词都使用小写字母，单词之间使用下划线进行分割，比如：my_name

  #+BEGIN_SRC python
    # 下划线命名法 -> 推荐使用
    my_name = '李四'
    # 小驼峰
    myName = '王五'
    # 大驼峰
    MyName = '赵六'
    print(myName)
  #+END_SRC

** 4. 关键字
关键字：在python里面具有特殊功能的标识符（理解成变量名、函数名），关键字不能作为变量名使用。
#+BEGIN_EXAMPLE
['False','None','True','and','as','assert','async','await','break','class','continue','def','del','elif','except','finally','for','from','global','if','import','in','is','lambda','nonlocal','not','or','pass','raise','return','try','while','with','yield']
#+END_EXAMPLE
