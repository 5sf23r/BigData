<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>JS验证表单不能为空</title>
<script>
	
	function checkData(){
		var canSub = true;
		canSub = checkUsername() && canSub;
		canSub = checkPsw() && canSub;
		canSub = checkPsw2() && canSub;
		canSub = checkEmail() && canSub;
		return canSub;
	}
	function checkUsername(){
		var flag = true;
		var obj = document.getElementsByName("username")[0];
		setMsg(obj.name,"")
		flag =  checkNull(obj,"用户名不能为空") && flag;
		if(flag == true){
			if(!/^[a-zA-Z_]\w{0,3}$/.test(obj.value)){
				setMsg(obj.name,"用户名必须以字母下划线开头,不能超过4位!");
				flag = false;
			}
		}
		return flag;
	}
	function checkPsw(){
		var flag = true;
		var obj = document.getElementsByName("password")[0];
		setMsg(obj.name,"")
		flag = checkNull(obj,"密码不能为空") && flag;
		if(flag == true){
			if(!/^\w{6,12}$/.test(obj.value)){
				setMsg(obj.name,"密码必须为字母或数字,必须是6-12位");
				flag = false;
			}
		}
		return flag;
	}
	function checkPsw2(){
		var flag = true;
		var obj = document.getElementsByName("password2")[0];
		setMsg(obj.name,"")
		flag = checkNull(obj,"确认密码不为空!") && flag;

		var psw = document.getElementsByName("password")[0].value;
		var psw2 = obj.value;
		if(psw != psw2){
			setMsg(obj.name,"两次密码要一致")
			flag = false;
		}
		return flag;
	}
	/*
		JavaScript中使用正则表达式需要用到正则表达式对象
			(1)var partt = /xxxxx/;
			(2)var partt = new RegExp("");
			
			boolean 正则对象.test(str)
			boolean String对象.match(正则对象);
	*/
	function checkEmail(){
		var obj = document.getElementsByName("email")[0];
		var flag = true;
		setMsg(obj.name,"")
		flag = checkNull(obj,"邮箱不能为空!");
		//xxxxxxx@xxxxx.xxx.xxx.xx.xx  --> /^\w+@\w+(\.\w+)+$/
		if(flag == true){
			if(!/^\w+@\w+(\.\w+)+$/.test(obj.value)){
				setMsg(obj.name,"邮箱格式不正确!");
				flag = false;
			}
		}
		return flag;
	}
	function setMsg(name,msg){
		document.getElementById(name+"_msg").innerText=msg;
	}

	function checkNull(obj,msg){
		if(obj.value == ""){
			setMsg(obj.name,msg)
			return false;
		}
		return true;
	}
</script>
<style type="text/css">
	span {
		font-size:12px;
		color:red;
	}
</style>
</head>

<body>
	
	<form action="success.html" method="post" onsubmit="return checkData()">
		<table align="center" border="1" borderColor="blue" cellpadding="7px" cellspacing="5px" bgcolor="pink" width="30%">
			<caption><font color="blue" size="+3">我的网站_注册表单</font></caption>
			<tbody>
				<tr>
					<td width="27%">用户名:</td>
					<td><input type="text" name="username" onblur="checkUsername()"/><span id="username_msg"></span></td>
				</tr>
				<tr>
					<td>密码:</td>
					<td><input type="password" name="password"  onblur="checkPsw()"/><span id="password_msg"></span></td>
				</tr>
				<tr>
					<td>确认密码:</td>
					<td><input type="password" name="password2" onblur="checkPsw2()"/><span id="password2_msg"></span></td>
				</tr>
				<tr>
					<td>电子邮箱:</td>
					<td><input type="text" name="email" onblur="checkEmail()"/><span id="email_msg"></span></td>
				</tr>
				<tr>
					<td colspan="2" align="center">
						<input type="submit" value="提交"/>
						<input type="reset" value="重置"/>
					</td>
				</tr>
			</tbody>
		</table>
	</form>
</body>
</html>